<!DOCTYPE html>
<html>
    <head>
    <title>Solr and Plone - Search and Beyond</title>
    <meta charset="utf-8">
    <style>
      @font-face {
        font-family: 'Yanone Kaffeesatz';
        font-style: normal;
        font-weight: 400;
        src: local('Yanone Kaffeesatz Regular'), local('YanoneKaffeesatz-Regular'), url(./fonts/Yanone_Kaffeesatz/YanoneKaffeesatz-Regular.ttf);
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;
      }
      @font-face {
        font-family: 'Droid Serif';
        font-style: normal;
        font-weight: 400;
        src: local('Droid Serif Regular'), local('DroidSerif-Regular'), url(./fonts/Droid_Serif/DroidSerif-Regular.ttf);
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;
      }
      @font-face {
        font-family: 'Ubuntu Mono';
        font-style: normal;
        font-weight: 400;
        src: local('Ubuntu Mono'), local('UbuntuMono-Regular'), url(./fonts/Ubuntu_Mono/UbuntuMono-Regular.ttf);
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;
      }

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      img {
          max-width: 100%;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }

      .outline {
          color: #999;
      }
      .current {
          color: black;
          font-weight: bold;
      }
    </style>
    </head>
    <body>
    <textarea id="source">

class: center, middle

# Solr and Plone - Search and Beyond

Manuel Reinhardt - Syslab.com - reinhardt@syslab.com

---

# Outline


---

exclude: true

# Solr

*   What is Solr?
*   Using Solr

---

# What is Solr?

*   Lucene indexing and search engine
*   Plus HTTP interface, caching, replication etc.
*   Open Source

???

*   Lucene Core
    *   Java-based indexing and search technology
    *   spellchecking, hit highlighting, analysis/tokenization
*   Solr
    *   high performance search server
    *   XML/HTTP and JSON/Python/Ruby APIs
    *   faceted search, caching, replication, web admin interface
*   Apache - Open Source

---

exclude: true

# Using Solr

Demo

---

# Connecting Solr to Plone

*   collective.solr
*   alm.solrindex
*   scorched & ploneintranet.search

???

*   Why?
    *   Speed
    *   Batching
    *   Complex queries
    *   Cross-site search

## Speed

*   Large SearchableText slows down whole catalog
*   Clear SearchableText in catalog
*   Let solr handle full text search

---

# collective.solr

*   Indexes both in catalog and solr (`collective.indexing`)
*   If SearchableText is in the query, divert to Solr


???

*   Patches portal_catalog
*   Patching
    *   Con
        *   Conflicts
        *   Less transparency
    *   Pro
        *   Easy to use
        *   Same interface

---

exclude: true

# collective.solr

*   Generalisation: Required query parameters
*   May be empty - always use solr

![Required query parameters](required-query-parameters-01.png)

---

# alm.solrindex

* Implements single index with a Solr connector

---

# scorched

*   low-level Solr API
    *   more powerful
    *   less convenient

```python
In [1]: si.query(SearchableText='test')
```

---

# ploneintranet.search

*   Based on scorched
*   Tuned towards Plone/Ploneintranet
*   Closer to portal_catalog but retains solr powers

---

# Benefits

---

## Boosting

*Total Control over your Search Results*

*    A good search shows the most relevant results first

--
*    Solr results are sorted by score

--
*    Influence score via boosting

--
*    Example: Date boost - recently added/modified content scores higher

---

## Highlighting

*Context for your Search Terms*

*    In what connection does this document mention my search term?
*    Solr can deliver snippets containing the search term

![UniBW Highlighting](unibw-highlighting-01.png)

---

## Cross-Site Search

*Search all your Content in one Place*

*   There's more than just your Plone site
*   What if the user doesn't know where the information is?

--
*   Index multiple sources into same Solr
    *   Other Plone sites
    *   Arbitrary sites with Nutch

--

*   Tweak query to search for all paths (not only /Plone)
*   Tweak results page to get external links right

---

## Cross-Site Search

![UniBW Cross-Site Search](unibw-cross-site-01.png)

---

## Complex Queries

*Formulate precisely what you want to find*

*   Give me all items that are
    *   inside Folder A *OR* Folder B

        *AND*

    *   that have been modified within the last week *OR* created within the last month
*   Catalog does only *AND*
*   Solr has flexible query language (AND/OR/NOT, parentheses, ...)

???

Real-world example?


    </textarea>

    <script src="remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
    </body>
</html>
